CREATE VIEW IF NOT EXISTS vw_order_details AS
SELECT 
    o.ORDER_ID,
    c.FIRST_NAME || ' ' || c.LAST_NAME AS customer_name,
    p.PRODUCT_NAME,
    oi.QUANTITY,
    p.PRICE,
    (oi.QUANTITY * p.PRICE) AS total_cost,
    o.ORDER_DATE
FROM ORDERS o
JOIN CUSTOMERS c ON o.CUSTOMER_ID = c.CUSTOMER_ID
JOIN ORDER_ITEMS oi ON o.ORDER_ID = oi.ORDER_ID
JOIN PRODUCTS p ON oi.PRODUCT_ID = p.PRODUCT_ID;
